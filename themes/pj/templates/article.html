{% extends 'base.html' %}
{% import 'shared/pub.html' as pub %}
{% block title %} {{page.title}} {% endblock %}
{% block body %}
  <h2>{{article.title}}</h2>
<p>
  {{pub.authorlist(article)}}
</p>
<hr>
{% if article.primarypaperurl %}
  <p><em>This <em>Physiome</em> paper describes data and models from the primary paper <a rel="noopener" target="_blank" href="{{article.primarypaperurl}}">{{article.primarypapername}}</a></em>.</p>
{% endif %}
<p>{% if article.mathsurl %}
  <a class="button alert small" href="{{article.mathsurl}}" rel="noopener" target="_blank">Maths</a>
{% endif %}
{% if article.codeurl %}
  <a class="button alert small" href="{{article.codeurl}}" rel="noopener" target="_blank">Code</a>
  {% endif %}
  {% if article.runmodelurl %}
  <a class="button alert small" href="{{article.runmodelurl}}">Launch with OpenCOR</a>
{% endif %}


</p>
{% if article.fulltexturl %}
<p>Fulltext available: 
  <a href="{{article.fulltexturl}}" target="_blank"><i class="fi-page" style="margin-right:5px"> </i>PDF</a>
</p>
{% else %}
  <p><em>Fulltext not yet available.</em></p>
  {% endif %}
  {% if article.primarypaper %}
  {% endif %}
  {% if article.documents %}
    <p>Extra documents:
      {% for doc in article.documents %}
	{% if loop.index is odd %}
	  <span style="margin-right:10px"><i class="fi-page" style="margin-right:5px"></i><a href="{{article.documents[loop.index0+1]}}">{{doc}}</a></span>
	{% else %}
	{% endif %}
      {% endfor %}
    </p>
  {% else %}
  {% endif %}
  {{article.content}}
  {% if article.modelviewurl %}
    <button class="button" name="Reset View" value="OK" type="button" onclick="resetView()">Reset View</button>
    <button class="button" name="View All" value="OK" type="button" onclick="viewAll()">View All</button>
    <script src="{{SITEURL}}/theme/js/models/three.min.js"></script>
    <script src="{{SITEURL}}/theme/js/models/zinc_threejs_control.js"></script>
    <script src="{{SITEURL}}/theme/js/models/zinc_3js_renderer.js"></script>
    <script>
      var currentModel = undefined;
      
      container = document.createElement( 'div' );
      document.body.appendChild( container );
      container.style.height = "500px"

      zincRenderer = new Zinc.Renderer(container, window);
      Zinc.defaultMaterialColor = 0xFFFF9C
      zincRenderer.initialiseVisualisation();
      
      
      load();
      zincRenderer.animate();
      
      function load() {
      var scene = zincRenderer.getCurrentScene();
      scene.loadViewURL("{{article.modelviewurl}}");
      {% for metadata_url in article.modelmetadataurls %}
	scene.loadMetadataURL("{{metadata_url}}");
      {% endfor %}
      var directionalLight = zincRenderer.getCurrentScene().directionalLight;
      directionalLight.intensity = 1.8;
      }

      
      function resetView()
      {
      zincRenderer.resetView();
      }
      
      function viewAll()
      {
      zincRenderer.viewAll();
      }

    </script>
  {% endif %}
{% endblock %}
